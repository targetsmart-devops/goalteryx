package goalteryx

import (
	"encoding/base64"
	"github.com/billgraziano/dpapi"
	"testing"
)

func TestDecrypt(t *testing.T) {

	data := `D08C9DDF0115D1118C7A00C04FC297EB010000000B9FF059BB420644AA09EA50E619D3CB04000000080000005000570044000000106600000001000020000000AC955BED6D7367808AE7319DC47F6421E6170BFC6300E49CD58416FF0E2726EB000000000E80000000020000200000003E652AF9995DAA7772DE1EE3BB618F1169FBCDB601FA73EDFB0C169603CB864D000400005144B10FC97A899EA6ED53AA96A6CFD52DEF8832E55512EBE2A8197BC7EAD374C9B21591C04913C1E82C1B4C6AD3B7172E64501F12D2B3927C8DE58FB9ADB13EA1001CF327EE7F0CF3776237CE6487A6A3F91E3A3E6E266D63F967F3838D863DAAB22B693CE505B04D32AA1A176DD4B759643EAD3C1E2251245EC9CE87C86940C610338EA10E62E31E89110D5DEEA65BBD2D62964EA41800BA36B2D36E8CC0B3FD59C10E71DE595A3AC06CF60AAD918E77865DA5DDC68C2DDFFC7178B3C5962413099353D08524A6CC2C0C98D0678E0F9EE9CAE6E5C7F13A7E25643A5B8FC16EAB260A2AB4DD7A8932DEBDE4D696CFFCF4B24953510C54F5DA04551E87AFE1F19BA38389263939E3280EB884CE0770249A3EE8106833724C6FC7030AC95C8AEEB1E3F196334D4A8F94363DBA1F859192BD09BD8784557BEFB079ADB2421FF55C03AD6A984438517DD95D4130877C287F3EDA2613F774DBE195037CFF5A1E1382D19EBBB24C47F147BB476AE34D382D83251D9C243B8D14D50E8B773DE1CD01377997E05CB9338F356B2A2FCDAD781EA5EC707F2F88AEEE359A6D4302298F07330DB98AF97C88371507566A17BE612869241D830F73F5F6C34EC9DA212D3DAB707533BF4F7F136CCDF85BBD989243BC50E4D3C8D8DCD575E59875E722958886EE163E79C6340FA90DC3E524750F97CFC2257027DDECC26E6F93638DCF0E33B4DA003BA7719928B9214662D66AB3E8AA91AF85DD96068846E551E81AC03C539903ECAC6C983DDFACF4713EF6960B6BC51FDF416177E170A397046193A2CA9A75DD863608DC4369BFD81DB9203009CAF8EDDCF070C3F5395DD733F098CCC1E9C998A80250D19659FD69986A5D56D4D76F51C8322F337E2DE60B7F213AB01F6F0E44783D8301EB49C82DF647DE922DE0341C85532B43EECC47003851E39D0515A9A6F6798D807C909C1A7EC9E54DD90DA1F97F9A5CECF121A7D9293E70DFA7C8D9A5A8484EEF24B70B24F2CABBC8D88119F194E0BDD4A6F7570A627A2895F4312BD1EAA40A180412E149A10FDDA98E1D71150F3F6EB4B60B20D103E2D94AEDF3CE045E1477E0849677F1AAAB976E94229FCE460489DE946AFC0C0D805AD7A3BF0F09E18FC4692ED9286F654A2924AEBA7D23CB115217B10E6059100F13715AB1705713CD98E94AE41036800878C90AC89C7CBA2D6978F1785B02B72C15A41D91BC9392117134FD912F27974FEC3E696DC6A98B12FFCF78F5A5DBA349F9D0A95F516438EABF545388C57CC76A6B5893E4DEED2D65F67DDF19FB1317DC9B3E8B85316DD6D3D2A2AAFA430D7EC6E91903F37C0A0828ED67BC57C6299C46E001EC67450C395C0312DEB7B54884F21A9A09F2A1F14796FBA7885146A4FCE34F497B5EE0C7FE73112FEBB83BCC4A76F1513B24F25925375DE608640B57813910835EB80EF0400000004F26AB2353D45A92C89794FEE9EDA5101496F2C2E08BD0460CA8FF4ACF049240EFA3A80A2A027D7CA3811CF0143141C242FD8076736266D1060A2760909C389F`
	raw, err := base64.StdEncoding.DecodeString(data)
	if err != nil {
		t.Fatalf(err.Error())
	}

	decrypted, err := dpapi.DecryptBytes(raw)
	if err != nil {
		t.Fatalf(err.Error())
	}
	t.Logf(string(decrypted))
}
