package goalteryx

import (
	"encoding/hex"
	"github.com/billgraziano/dpapi"
	"testing"
)

func TestDecrypt(t *testing.T) {

	data := `01000000D08C9DDF0115D1118C7A00C04FC297EB01000000FCD673B79A6E354B98CA38C62453ACC2000000000800000050005700440000001066000000010000200000005C097CE3BC8612F008BEC3B039E8EB1FD3D3878989F70CDFBEDF4D1D9649F733000000000E8000000002000020000000135086019FD279562A975F1BD5868734860C597EF4F17A79879604BC28F40D710004000021773FB267AC186D9EAAB251A8D840CD070DF58F36BF455D731DC52F31B97925C6328AD2B2B683E77288C512D9D2DF84A660B9C38739CE730CB0FFB213D28DDD7617ED998027F80D30635EA51A61AC0ED083A0EE51750B4172A91FCEB391FA7091B385E1D2BB0E3632911E3B27F1340228FEB009E31A731A61AD064EE3A703235EB76665AB0E917DA5946EF0BC02DC2F988B971DCAA1DA8F5A623076590AF11786B3420E7113DA7A69672F8067833738DD7F89A75749440D6474626A09AD8C92B7EB889B5BB7F405A7FD18DF960A4B9DC1CDEC230AE1B4CCA9ADF7262E7DADA9B6A3D4AAB89F4A80C810E02AAE1EC8462B9352A462F00D18EC573668B4F8C7E4C548FA388CC866A2AFC399361D8A9DC2EEA0CD8F0A7A27AA081244CE5531E65E1616D571D78A84172A20B222BF33C4E88D74E896F8E0283916DDD3DCDBB60BA3B19F371176025121ABD1DF8B0B73D2965AEA6FBAD217EEE3F7B8AF6668FACE860BD267AAC6C100ADEE00FCC792054054B70017E8D2CA895B23F95CAC86D235E6A4635B5B186120FFCC923146F33FA023E58981DAE1BBA34D16ABD70A32E925123ADF2A0A47E4FDC5C19D9D61CABE118FDA765D55D43ABBD3D59816216160093F7508AAA22C165B2A71218EA22DBD16234ECE8F227641E49DC786FF937E382E2CC5E6782F1FD6A61AA571BA388BA04C6FB91698CA9D987AA8F7C7A3637DFF54EC59ADB9B893D25923E711776F69FE3A77BEA11A6AC572E4B46E670437C78499B645ADC8E6C4149B90F3CD7830B45EAE5D0941D7E06C69A09291EBE25EA05ED1770337CCC02031A26E8A9D56E8D16D2B5E6633FE9AB0552156FBAC80BCBE9074BF0658A383BE9AF2ADFC442A218C54CDAFF7C2799B7563D8674183A432EB23C3A1967A73F9927367A2472EA47F0F89892349F9D836014A1C18D841258BA33B43C9698FCD9A9FEAF4E05658EA9159E99C16FC2F63AF4E90A82750670A09204B2E3CDF9DCB6DDEDC681FD0B23080F9B1358F2DF01B5FAED7ED07DDC17959CD0871A364EE266963B89B726BDC33EEAA456BC9BAC0C992580C1E813D70D988406CA9A9F3B83C574C04301F5E647ED553B987560E331687D880E87BB1C523CC7649ABFC1CD39023F45B41B5D530A33CA365396D3E26246E12E8ABAE65074F70221D12937B9CAAF2597C9362778D8E827F7296B00243AD2A1963BD7D0EF6EAAE57C9DBACC8FE50F22369B356CDDD230E54F95469B8F7396AB3D151A6FC2661D14813344240E83671C68D178297ECCC17AA1BD39659823071E3A3F4D25F3667F7BEC2D95DE9D8AFD71529E9DBFD628F629890985DAC7DE62BA582797C1C6DD06127A057BBC6D6D2F6A4D54A375DF7C97362045CD4B625360ECA4DE485429F00334E342C6EE91A42DB979335B264EB9BEBF62EABD3BA83C5215DBAE397B8419D4A62EC978E40000000C96D542B27B569B1437EFCB14F257FA7148A2BE868AC8C8A90CF9EB15183A5962BF6655176B049A954290FB2C8CC4306FB8B10ED7EB9475F87B97579ADB963E1`
	raw, err := hex.DecodeString(data)
	if err != nil {
		t.Fatalf(err.Error())
	}

	decrypted, err := dpapi.DecryptBytes(raw)
	if err != nil {
		t.Fatalf(err.Error())
	}
	t.Logf(string(decrypted))
}
